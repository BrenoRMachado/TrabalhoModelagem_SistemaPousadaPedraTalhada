<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Financeiro - Pousada Pedra Talhada</title>
    <link rel="stylesheet" href="../../../public/css/styles.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons+Round" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="../../../public/js/room-manager.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Estilos específicos da página de financeiro */
        .sidebar { position: fixed; left: 0; top: 0; width: 260px; height: 100vh; background: #FFFFFF; padding: 20px; box-shadow: 2px 0 8px rgba(0,0,0,0.1); overflow-y: auto; }
        .sidebar-logo { font-size: 24px; font-weight: 700; color: #5D4037; margin-bottom: 30px; }
        .sidebar-menu { list-style: none; }
        .sidebar-menu li { margin-bottom: 10px; }
        .sidebar-menu a { display: flex; align-items: center; padding: 12px 16px; color: #666; text-decoration: none; border-radius: 8px; transition: all 0.3s ease; }
        .sidebar-menu a:hover, .sidebar-menu a.active { background: #F5F5F5; color: #5D4037; font-weight: 600; }
        .sidebar-menu .material-icons-round { margin-right: 12px; font-size: 20px; }

        main { margin-left: 260px; padding: 30px; background: #F5F7FA; min-height: 100vh; }
        
        .page-header { margin-bottom: 30px; }
        .page-header h1 { margin: 0; font-size: 28px; color: #333; margin-bottom: 10px; }

        .filter-container { display: flex; gap: 15px; margin-bottom: 30px; flex-wrap: wrap; align-items: flex-end; }
        .filter-group { flex: 1; min-width: 150px; }
        .filter-group label { display: block; margin-bottom: 8px; font-weight: 600; font-size: 12px; color: #333; text-transform: uppercase; }
        .filter-group input, .filter-group select { width: 100%; padding: 10px; border: 1px solid #E0E0E0; border-radius: 8px; font-size: 14px; }
        .filter-group input:focus, .filter-group select:focus { outline: none; border-color: #5D4037; }

        .btn { padding: 10px 20px; border: none; border-radius: 8px; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.3s ease; display: inline-flex; align-items: center; gap: 8px; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
        .btn-primary { background: #5D4037; color: white; }
        .btn-primary:hover { background: #4E342E; }

        .dashboard-cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .card { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .card h3 { margin: 0 0 10px 0; font-size: 12px; color: #666; text-transform: uppercase; font-weight: 600; }
        .card .value { font-size: 28px; font-weight: 700; color: #333; margin-bottom: 5px; }
        .card .label { font-size: 12px; color: #999; }
        .card.success .value { color: #00C853; }
        .card.warning .value { color: #FFAB00; }
        .card.danger .value { color: #FF3D00; }

        .charts-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .chart-box { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        .chart-box h2 { font-size: 16px; color: #333; margin: 0 0 20px 0; }

        .table-container { background: white; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); overflow: hidden; }
        table { width: 100%; border-collapse: collapse; }
        table thead { background: #F5F5F5; border-bottom: 2px solid #E0E0E0; }
        table thead th { padding: 16px; text-align: left; font-weight: 600; color: #333; }
        table tbody td { padding: 16px; border-bottom: 1px solid #E0E0E0; color: #666; }
        table tbody tr:hover { background: #FAFAFA; }

        .transaction-type { display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; text-transform: uppercase; }
        .transaction-revenue { background: #E8F5E9; color: #00C853; }
        .transaction-expense { background: #FFEBEE; color: #FF3D00; }

        .amount-positive { color: #00C853; font-weight: 600; }
        .amount-negative { color: #FF3D00; font-weight: 600; }

        .export-section { display: flex; gap: 15px; margin-bottom: 30px; }

        @media (max-width: 768px) {
            .sidebar { width: 100%; height: auto; position: relative; margin-bottom: 20px; }
            main { margin-left: 0; padding: 15px; }
            .filter-container { flex-direction: column; }
            .filter-group { min-width: 100%; }
            .charts-container { grid-template-columns: 1fr; }
            table { font-size: 12px; }
            table thead th, table tbody td { padding: 8px; }
        }
    </style>
</head>
<body>

    <div class="app-container">
        <aside class="sidebar">
            <div class="brand">
                <div class="logo-icon"><span class="material-icons-round">apartment</span></div>
                <div>
                    <strong>Pousada Pedra</strong><br>Talhada
                </div>
            </div>

            <nav>
                <a href="index.html"><span class="material-icons-round">dashboard</span> Dashboard</a>
                <a href="reservas.html"><span class="material-icons-round">description</span> Reservas</a>
                <a href="hospedes.html"><span class="material-icons-round">people</span> Hóspedes</a>
                <a href="financeiro.html" class="active"><span class="material-icons-round">assessment</span> Financeiro</a>
                <a href="usuarios.html"><span class="material-icons-round">security</span> Equipe e Acessos</a>               
                <a href="login.html" class="logout-link">
                    <span class="material-icons-round">logout</span> Sair
                </a>
            </nav>
        </aside>

    <!-- CONTEÚDO PRINCIPAL -->
    <main>
        <div class="page-header">
            <div>
                <h1>Controle de Caixa</h1>
                <p style="margin:6px 0 0 0; color:#666;">Gerencie as movimentações financeiras</p>
            </div>
        </div>

        <!-- KPIs -->
        <div class="dashboard-cards">
            <div class="card">
                <h3>Saldo Inicial</h3>
                <div style="display:flex; align-items:center; gap:12px;">
                    <div style="background:#E3F2FD; color:#1976D2; width:44px; height:44px; border-radius:8px; display:flex; align-items:center; justify-content:center;"><span class="material-icons-round">account_balance_wallet</span></div>
                    <div>
                        <div class="value">R$ 200,00</div>
                        <div class="label">Caixa</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Entradas do Dia</h3>
                <div style="display:flex; align-items:center; gap:12px;">
                    <div style="background:#E8F5E9; color:#00C853; width:44px; height:44px; border-radius:8px; display:flex; align-items:center; justify-content:center;"><span class="material-icons-round">trending_up</span></div>
                    <div>
                        <div class="value" style="color:#00C853;">R$ 2.000,00</div>
                        <div class="label">Hoje</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Saldo Atual</h3>
                <div style="display:flex; align-items:center; gap:12px;">
                    <div style="background:#E3F2FD; color:#1976D2; width:44px; height:44px; border-radius:8px; display:flex; align-items:center; justify-content:center;"><span class="material-icons-round">attach_money</span></div>
                    <div>
                        <div class="value">R$ 1.700,00</div>
                        <div class="label">Saldo</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- BARRA DE AÇÕES -->
        <div style="display:flex; gap:12px; margin-bottom:20px;">
            <button class="btn" style="background:#00C853; color:white;">Abrir Caixa</button>
            <button class="btn" style="background:#FF6D00; color:white;">Registrar Sangria</button>
            <button class="btn" style="background:#D50000; color:white;">Fechar Caixa</button>
        </div>

        <!-- CARTÕES DE RESUMO -->
        <div class="dashboard-cards">
            <div class="card success">
                <h3>Receita Total</h3>
                <div class="value">R$ 8.500,00</div>
                <div class="label">Jan 2026</div>
            </div>
            <div class="card warning">
                <h3>Despesas</h3>
                <div class="value">R$ 1.200,00</div>
                <div class="label">Jan 2026</div>
            </div>
            <div class="card success">
                <h3>Lucro Líquido</h3>
                <div class="value">R$ 7.300,00</div>
                <div class="label">Receita - Despesas</div>
            </div>
            <div class="card">
                <h3>Taxa de Ocupação</h3>
                <div class="value">85%</div>
                <div class="label">6 de 7 quartos</div>
            </div>
        </div>

        <!-- GRÁFICOS -->
        <div class="charts-container">
            <div class="chart-box">
                <h2>Receita vs Despesas (Últimos 7 dias)</h2>
                <canvas id="revenueExpenseChart"></canvas>
            </div>
            <div class="chart-box">
                <h2>Distribuição de Receita por Fonte</h2>
                <canvas id="revenueSourceChart"></canvas>
            </div>
        </div>

        <!-- BOTÕES DE EXPORTAÇÃO -->
        <div class="export-section">
            <button class="btn btn-blue" onclick="exportReport('pdf')">
                <span class="material-icons-round">picture_as_pdf</span> Exportar PDF
            </button>
            <button class="btn btn-blue" onclick="exportReport('excel')">
                <span class="material-icons-round">table_chart</span> Exportar Excel
            </button>
        </div>

        <!-- MOVIMENTAÇÕES RECENTES -->
        <h2 style="margin-top:0; margin-bottom:12px;">Movimentações Recentes</h2>
        <div class="table-container">
            <table id="transactionsTable">
                <thead>
                    <tr>
                        <th>Descrição</th>
                        <th>Tipo</th>
                        <th>Valor</th>
                        <th>Hora</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Pagamento Reserva 102</td>
                        <td><span class="transaction-type transaction-revenue">Entrada ↑</span></td>
                        <td class="amount-positive">R$ 850,00</td>
                        <td>14:30</td>
                    </tr>
                    <tr>
                        <td>Pagamento Reserva 203</td>
                        <td><span class="transaction-type transaction-revenue">Entrada ↑</span></td>
                        <td class="amount-positive">R$ 450,00</td>
                        <td>13:15</td>
                    </tr>
                    <tr>
                        <td>Sangria para banco</td>
                        <td><span class="transaction-type transaction-expense">Saída ↓</span></td>
                        <td class="amount-negative">R$ 500,00</td>
                        <td>12:00</td>
                    </tr>
                    <tr>
                        <td>Pagamento Reserva 301</td>
                        <td><span class="transaction-type transaction-revenue">Entrada ↑</span></td>
                        <td class="amount-positive">R$ 700,00</td>
                        <td>10:45</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </main>

    <script>
        // Gráfico de Receita vs Despesas
        const revenueExpenseCtx = document.getElementById('revenueExpenseChart').getContext('2d');
        new Chart(revenueExpenseCtx, {
            type: 'bar',
            data: {
                labels: ['Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'Sab', 'Dom'],
                datasets: [
                    {
                        label: 'Receita',
                        data: [1200, 1400, 1100, 1600, 1300, 1800, 1100],
                        backgroundColor: '#00C853',
                        borderRadius: 8
                    },
                    {
                        label: 'Despesas',
                        data: [300, 200, 150, 250, 200, 300, 250],
                        backgroundColor: '#FF3D00',
                        borderRadius: 8
                    }
                ]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });

        // Gráfico de Distribuição de Receita
        const revenueSourceCtx = document.getElementById('revenueSourceChart').getContext('2d');
        new Chart(revenueSourceCtx, {
            type: 'doughnut',
            data: {
                labels: ['Hospedagem', 'Minibar', 'Room Service', 'Outros'],
                datasets: [{
                    data: [7200, 800, 400, 100],
                    backgroundColor: ['#5D4037', '#00C853', '#FFAB00', '#1976D2'],
                    borderColor: '#fff',
                    borderWidth: 2
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'bottom'
                    }
                }
            }
        });

        function filterByPeriod() {
            const period = document.getElementById('periodFilter').value;
            const today = new Date();
            let startDate, endDate;

            switch(period) {
                case 'today':
                    startDate = new Date(today);
                    endDate = new Date(today);
                    break;
                case 'week':
                    startDate = new Date(today.setDate(today.getDate() - today.getDay()));
                    endDate = new Date();
                    break;
                case 'month':
                    startDate = new Date(today.getFullYear(), today.getMonth(), 1);
                    endDate = new Date();
                    break;
                case 'year':
                    startDate = new Date(today.getFullYear(), 0, 1);
                    endDate = new Date();
                    break;
                default:
                    return;
            }

            document.getElementById('startDate').value = startDate.toISOString().split('T')[0];
            document.getElementById('endDate').value = endDate.toISOString().split('T')[0];
        }

        function applyFilters() {
            alert('Filtros aplicados! Dados serão atualizados.');
        }

        function exportReport(format) {
            alert('Relatório será exportado em formato ' + format.toUpperCase());
        }
    </script>
</body>
</html>
